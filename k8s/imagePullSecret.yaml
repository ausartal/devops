---
# This file demonstrates how to create the ImagePullSecret
# required for pulling images from a private Docker registry (Harbor/DockerHub)

# ========================================================
# METHOD 1: Create secret using kubectl command
# ========================================================
# kubectl create secret docker-registry harbor-registry-secret \
#   --docker-server=harbor.example.com \
#   --docker-username=your-username \
#   --docker-password=your-password \
#   --docker-email=your-email@example.com \
#   -n dev-ahmad

# kubectl create secret docker-registry harbor-registry-secret \
#   --docker-server=harbor.example.com \
#   --docker-username=your-username \
#   --docker-password=your-password \
#   --docker-email=your-email@example.com \
#   -n staging-ahmad

# ========================================================
# METHOD 2: Create secret using YAML (after base64 encoding)
# ========================================================

# First, create the docker config JSON:
# {
#   "auths": {
#     "harbor.example.com": {
#       "username": "your-username",
#       "password": "your-password",
#       "email": "your-email@example.com",
#       "auth": "base64-encoded-username:password"
#     }
#   }
# }

# To get the auth value:
# echo -n "your-username:your-password" | base64

# Then base64 encode the entire JSON:
# echo -n '{"auths":{"harbor.example.com":{"username":"your-username","password":"your-password","email":"your-email@example.com","auth":"dXNlcjpwYXNz"}}}' | base64

apiVersion: v1
kind: Secret
metadata:
  name: harbor-registry-secret
  namespace: dev-ahmad
type: kubernetes.io/dockerconfigjson
data:
  # Replace this with your base64-encoded docker config JSON
  .dockerconfigjson: ewoJImF1dGhzIjogewoJCSJoYXJib3IuZXhhbXBsZS5jb20iOiB7CgkJCSJ1c2VybmFtZSI6ICJ5b3VyLXVzZXJuYW1lIiwKCQkJInBhc3N3b3JkIjogInlvdXItcGFzc3dvcmQiLAoJCQkiZW1haWwiOiAieW91ci1lbWFpbEBleGFtcGxlLmNvbSIsCgkJCSJhdXRoIjogImVYVnpaWEl0Ym1GdFpUcDViM1Z5TFhCaGMzTjNiM0prIgoJCX0KCX0KfQ==

---
apiVersion: v1
kind: Secret
metadata:
  name: harbor-registry-secret
  namespace: staging-ahmad
type: kubernetes.io/dockerconfigjson
data:
  # Replace this with your base64-encoded docker config JSON
  .dockerconfigjson: ewoJImF1dGhzIjogewoJCSJoYXJib3IuZXhhbXBsZS5jb20iOiB7CgkJCSJ1c2VybmFtZSI6ICJ5b3VyLXVzZXJuYW1lIiwKCQkJInBhc3N3b3JkIjogInlvdXItcGFzc3dvcmQiLAoJCQkiZW1haWwiOiAieW91ci1lbWFpbEBleGFtcGxlLmNvbSIsCgkJCSJhdXRoIjogImVYVnpaWEl0Ym1GdFpUcDViM1Z5TFhCaGMzTjNiM0prIgoJCX0KCX0KfQ==

# ========================================================
# USAGE IN DEPLOYMENT
# ========================================================
# The deployment.yaml file references this secret:
#
# spec:
#   imagePullSecrets:
#     - name: harbor-registry-secret
#
# This allows Kubernetes to pull images from the private registry
# ========================================================

# ========================================================
# VERIFICATION
# ========================================================
# To verify the secret is created correctly:
#
# kubectl get secret harbor-registry-secret -n dev-ahmad
# kubectl get secret harbor-registry-secret -n staging-ahmad
#
# To view the secret content (decoded):
# kubectl get secret harbor-registry-secret -n dev-ahmad -o jsonpath='{.data.\.dockerconfigjson}' | base64 --decode
# ========================================================
